# WorldVoice

WorldVoice 是依据 VE driver 为基础开发而成的 addon。运行于 NVDA 2019.3 以上。

主要包括有多国语音自动切换、各别语音速度设定、朗读行为客制(数字读法、中文空格间隔)、自定义文字地区等功能。

## 安装

*	下载主程序addon WorldVoice、VE 语音包addon、VE 核心包。
*	安装主驱动 addon
*	核心包可透过 WorldVoice -> 档案汇入将 zip 压缩包汇入语音组件工作区。
*	语音包安装方式
	*	基本：使用兼容于 Vocalizer for NVDA 的语音包addon，[官方下载点](https://vocalizer-nvda.com/downloads)。
	*	进阶：可透过各种语音包内直接复制其内的地区文件夹(ex: en, mnc, mnt)等并将其压成 zip 压缩包后透过 WorldVoice 接口的档案汇入功能汇入addon内，与核心包相同需留意汇入之工作区，如无特殊需求建议使用 addon 版本安装，因 addon 版本可共享同时提供第 1 驱动与第 2 驱动使用。

## 相依性套件

除以上安装外，为驱动 VE 核心，需安装 [VC++ Redistributable Packages 2012](https://www.microsoft.com/en-US/download/details.aspx?id=30679)的 x86 版本 (VSU_4\vcredist_x86.exe) 后即可顺利驱动。

## 使用

*	NVDA+ctrl+S 选择 WorldVoice 语音合成器。
*	NVDA+ctrl+V 有基本语音速度、音调、音量等基本设定，其中数字模式、中文空白间隔为 WorldVoice 多的客制设定。
	*	数字读法：分为 2 个维度设定选项「数字语言」与「数字模式」，数字语言设定数字朗读时使用的地区语音、数字模式分为数值与数字两种
	*	中文空白间隔：可设定中文间有空白时，欲停顿长度，数字愈小停顿愈短， 0 为不停顿。
*	 WorldVoice -> 语音设定：可设定不同地区所使用的语音角色、各别语音角色速度、音调、音量、自动语音切换设定。
	*	先选择地区后语音列表会列出该地区可用的语音角色，选择后即完成该地区与语音角色的对应纪录。
	*	当语音角色有选择时，下方速度、音调、音量滑杆会变为该语音角色的设定值。
	*	速度、音调、音量是依不同语音角色区分，每个语音角色有各自不同的速度数值，而非依地区区分。
	*	用 unicode 编码侦测文字语言勾选后，程序会根据读到的字符侦测地区。
	*	侦测语言时忽略数字、侦测语言时忽略常见标点符号勾选后，数字与标点符号会判定为默认语音的地区文字。
*	 Unicode 设定：可定义字符的语言并依上下文或强制模式来判断字符语言，当「用 unicode 编码侦测文字语言」勾选后自动侦测的判断会加入此配置文件的规则，此功能可解决 NVDA 内部的 symbol 转换规则造成在自动切换语言下不朗读之问题。例如在某些情形下「.」不读取时则可试着在规则中加入「.」的符号并选择语言与模式来使其正确读出。
*	 WorldVoice -> 档案汇入：可汇入档案，可用于汇入核心包与语音包。

## 更新版本日志

### v1.1

*	新增数字模式的选项，可选择有安装的语言朗读数字并可分为数值与数字两种。
*	新增忽略文件中的语言信息的选项，此主要是避免自动切换语言勾选且原始文件就有提供语言信息但不正确时(例如中文文字确标示英文语言)可能导致无法正确朗读；或是在 word 数字会被标示成英文语言导致自动改用英文语音朗读的状况。
*	优化中文空白间隔，使中文对象与中文属性间亦可停顿
*	加入其他中文语系的接口翻译
*	略过从配置文件加载变声功能，因目前 VE driver 底层的变声功能无法正常使用且换语音时容易因设定值不符加载失败导致要删整个配置文件才能解决
*	合并 VE driver 3.1.2 的更新
*	其他细部优化

### v1.2

*	提供第 2 驱动核心，整体相比第 1 驱动核心顺畅，无偶尔速度不一致与小爆音问题
*	第 2 驱动功能比照第 1 驱动包括数字模式、中文空白间隔、忽略文件中的语言信息等选项
*	第 2 驱动提供各语音速度、音调、音量各别调整，但与第 1 驱动对应数值不同，亦即第 1 驱动的速度 50 与 第 2 驱动的速度 50 不会有相同的语音速度
*	修正数字模式在选择各数值语音下时间与小数点无正确朗读的问题
*	修正无定义字符地区信息时不朗读的问题
*	修正数字模式在选择各数字语音下无正确使用选择的语音的问题
*	调整数字模式与忽略文件中的语言信息处理顺序，更符合预期朗读逻辑

### v1.3

*	加入 unicode 设定功能
*	修正单数字不会自动切换的问题
*	修正数字模式在特定场景下失效问题
*	移除 v1.2 的第1驱动
*	调整程序结构并预支持更多 TTS

### v1.4

*	修正检视报读内容开启时无语音
*	音调内部数值换算百分比改非线性计算，让默认值为 50
*	修正 unicode rule 强制模式下后方文字侦测错误
*	修正初始值类型错误导致语音设定对话框无法显示
*	初始语音改优先使用默认语言之语音

### v1.5

*	数字读法分为 2 个设定选项「数字语言」与「数字模式」，将选项分为 2 维度以利选择
*	忽略数字间逗点选项使数值报读更正确
*	自动侦测语言功能当信任语音语言勾选时才使用不同解释档
*	语音设定中的值调整按确认才生效按取消会回到设定前的值
*	修正语音设定中当语音与默认语音相同时调整设定值后重启 NVDA 后回到设定前的值
*	将自动语言切换设定与语音设定窗口合并
*	地区与语音对应加入 no-select 用来取消对应
*	支持快捷键弹出语音设定与 Unicode 设定
