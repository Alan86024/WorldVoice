# WorldVoice

在高度网络化及国际化的年代，语言的学习更显其重要性，在语言学习教材中通常是以母语辅助解释外国语言的词汇、句意，二种语言以上的夹杂撰写的情形非常普遍。日常生活中，我们也经常在交流讨论时夹杂多种语言文字。在书报、网络文章中也时常能看多种语言穿插撰写传达信息，更有甚者在同一语句以中英文、中日文等文字拼凑形式呈现。

不同数字内容（语言学习、数理学门、文学作品）的文字组成、上下文语意、跨语系频率等等特性皆会有差异，相对语音报读的方式亦可能需依不同数字内容而有所微调以更符合该类文件的需求。

WorldVoice 提供丰富的客制化设定选项让用户在不同情境下可有不同的设定能力，最大化满足不同族群使用者的需求。

WorldVoice 是一款多国语音朗读 NVDA 附加组件，可使用在高于 2020.1 版以上的 NVDA 中。

主要包括功能：

*	多国语系语音自动切换
*	各别语音参数(速度、音调、音量)设定
*	多语音引擎互相搭配选用
*	数字读法切换(数字与数值)
*	朗读行为客制(角色切换停顿长度、中文空白停顿长度、忽略在数字间的逗号)
*	自定义文字所属地区

WorldVoice 支持 Aisound, OneCore, RHVoice, SAPI5, VE 五种语音引擎互相搭配选用

## 安装

*	安装 WorldVoice 附加组件
*	Aisound 与 VE 需额外安装核心包后才可使用
	*	安装核心包：透过 WorldVoice -> VE 核心安装、 Aisound 核心安装，将对应的核心包 zip 文件汇入附加组件工作区。
	*	为了驱动 VE 核心，操作系统内需安装 [VC++ Redistributable Packages 2012](https://www.microsoft.com/en-US/download/details.aspx?id=30679)的 x86 版本 (VSU_4\vcredist_x86.exe) ，如您已安装核心包与语音包后仍无法加载 WorldVoice 合成器，请试着安装此组件。
*	RHVoice 与 VE 需额外安装语音包后才可使用
	*	RHVoice 附加组件形式：使用官方提供的语音包附加组件，[官方下载点](https://rhvoice.org/languages/)。
	*	VE 附加组件形式：使用兼容于 Vocalizer for NVDA 的语音包附加组件，[官方下载点](https://vocalizer-nvda.com/downloads)。
	*	VE 压缩包形式：可透过各种语音包内直接复制其内的地区文件夹(ex: en, mnc, mnt)等并将其压成 zip 压缩包后透过 WorldVoice 接口的档案汇入功能汇入 addon 内，如无特殊需求建议使用 addon 版本安装。

## 设定

NVDA+ctrl+S 切换为 WorldVoice 语音合成器。

### 主要语音角色设定

透过 NVDA 设定: 语音(NVDA+ctrl+V) 设定基底语音角色与共通行为

*	语音速度、音调、音量设定
*	数字读法：分为 2 个设定选项「数字语言」与「数字模式」，数字语言设定数字朗读时使用的语音角色、数字模式分为数值与数字两种
*	中文空白停顿长度：设定中文间空白时停顿的长度，数字愈小停顿愈短， 0 为不停顿。
*	忽略在数字间的逗号：选项勾选时会忽略数字中间的逗号，可让数字位数的逗号标错位置仍能正常朗读数值。
*	启用 WorldVoice 设定规则来侦测文字语言：当选项勾选时，会使用语音设定内的规则来侦测文字语言并切换语音朗读。在部份情境此选项会与 NVDA 自动切换语言有兼容性问题，建议两者不要同时勾选。

### WorldVoice 语音设定（NVDA 菜单 -> WorldVoice -> 语音设定）

语音角色：可设定不同地区所使用的语音角色、各别语音角色速度、音调、音量、主要语音角色与地区语音角色一致性设定。

*	选择地区后语音列表会列出该地区可用的语音角色，选择后即完成该地区与语音角色的对应纪录。
*	选择语音角色后变声列表会列出该语音角色可用的变声，选择后即完成该语音角色与变声的对应纪录。
*	当语音角色有选择时，下方速度、音调、音量滑杆会变为该语音角色的设定值。
*	速度、音调、音量是依不同语音角色区分，每个语音角色有各自不同的速度数值，而非依地区区分。
*	保持主要语音引擎与地区语音引擎一致：将 NVDA 语音设定中的语音（主要语音）角色与 WorldVoice 语音设定中的地区对应语音（地区语音）引擎一致，当主要语音设定调整时，地区语音同步调整为相同的语音引擎。
*	保持主要语音角色与地区语音角色一致：将 NVDA 语音设定中的语音（主要语音）角色与 WorldVoice 语音设定中的地区对应语音（地区语音）角色一致，当主要语音或地区语音设定调整时，同步调整双方的语音角色设定。
*	保持主要语音参数与地区语音参数一致：将 NVDA 语音设定中的语音（主要语音）与 WorldVoice 语音设定中的地区对应语音（地区语音）参数（速度、音调、音量）一致，当主要语音或地区语音设定调整时，同步调整双方的语音参数设定。

语言设定：

*	用 unicode 编码侦测文字语言勾选后，程序会根据读到的字符侦测文字所属地区。
*	侦测语言时忽略数字、侦测语言时忽略常见标点符号勾选后，数字与标点符号会判定为主要语音的地区文字。
*	侦测语言时间点：文字自动侦测语言时间点在 NVDA 的符号处理前或后进行。当选择「符号处理后」项目时，可防止与其他使用到语音模块附加组件(ex: Instant Translate)的冲突。

其他：

*	OneCore 提高语速：勾选后 OneCore 的语音角色速度会更快
*	VE 停顿参数：设定 VE 语音 session 开始与结束的停顿长度。（遇到句号或语音角色切换时皆会结束当前这条语音 session 并重启一条新的语音 session）

### 其他设定：

WorldVoice -> Unicode 设定：可定义字符所隶属的地区并依上下文或强制模式来判断字符的地区，当「用 unicode 编码侦测文字语言」勾选后自动侦测的判断会加入此配置文件的规则，此功能可解决 NVDA 内部的 symbol 转换规则造成在自动切换语言下不朗读之问题。例如在某些情形下「.」不读取时则可试着在规则中加入「.」的符号并选择语言与模式来使其正确读出。

WorldVoice -> 档案汇入：可汇入档案，可用于汇入语音包。

## 更新版本日志

### v3.4

* 新增数字间停顿，提身数字内容听读判断
* 新增项目间停顿功能，提身对象信息听读判断
* 修正 VE 数字模式为数值时会合并相邻数字成为单一数值报读
* 修正 OneCore 语速调整问题
* 修正 VE 开启「光标移动时延迟读出字符的字词解释」后游标移动卡顿问题
* 修正 OneCore 与 RHVoice 「光标移动时延迟读出字符的字词解释」无效的问题

### v3.3

* 支援 OneCore engine
* 地区与语音角色对应为 No Select 时使用主语音朗读
* 修正符号转中文报读时会套用到中文空白停顿参数的问题
* 语音设定使用类别设定对话框，分为语音角色、语言切换、其他
* 在语音设定中的其他分类下加入 OneCore 加快语速开关
* 支援 RHVoice engine


### v3.2

*	修正在语音合成器非选择 WorldVoice 时，语音设定问题，改以显示提示文字
*	修正 aisound 音量调整问题
*	修正语音设定中侦测语言时间点的重启条件
*	修正长按按键后语音无法中断问题
*	修正多项语意问题(flake8)
*	兼容于 NVDA 版本 2022.1

### v3.1

*	在网页浏览中中断无声报读
*	shift 可暂停/继续语音报读
*	按加减音量键不会中断报读
*	保持主要语音引擎与地区语音引擎一致功能
*	修正 VE 停顿的方式

### v3.0

*	支持 SAPI5 语音引擎
*	支持 Aisound 语音引擎
*	语音设定内新增语音角色切换时停顿长度
*	语音设定内新增 unicode 正规化方式选项
*	语音角色排序方式调整依语音引擎、语音角色名称排序

### v2.2

*	语音设定内新增变声选项，需依序设定地区、语音、变声选项
*	修政侦测语言时间点选「符号处理前」后无法再变更之问题
*	新增阿拉伯语系翻译

### v2.1

*	兼容于 NVDA 版本 2019.3~ 2021.1
*	可套用 NVDA 不同组态设定
*	移除输入手势的多余项目
*	速度内部数值换算百分比改非线性计算
*	设定选单调整将「在符号处理后侦测文字语言」更改为「侦测语言时间点」
*	侦测语言时间点：字符自动侦测语言时间点在 NVDA 的符号处理前或后进行。当选择「符号处理后」项目时，可防止与其他使用到语音模块附加组件(ex: Instant Translate)的冲突
*	保持主要语音参数与地区语音参数一致：将 NVDA 语音设定中的语音（主要语音）与 WorldVoice 语音设定中的地区对应语音（地区语音）参数（速度、音调、音量）一致，当主要语音或地区语音设定调整时，同步调整双方的语音参数设定
*	保持主要语音角色与地区语音角色一致：将 NVDA 语音设定中的语音（主要语音）角色与 WorldVoice 语音设定中的地区对应语音（地区语音）角色一致，当主要语音或地区语音设定调整时，同步调整双方的语音角色设定

### v2.0

*	相容 NVDA 2021.1

### v1.7

*	小数点不读修正(三数字间皆有小数点情形)
*	兼容 NVDA 2021.1 以前的最后一版

### v1.6

*	修正数字模式下小数点不朗读问题
*	更新 VE 核心包工作目录，未来更新时可无需重新汇入
*	将「使用 WorldVoice 设定规则针测语言」的开关与「自动切换语言」的开关分开，避免部份情境两者不兼容问题。
*	修正启用 unicode 自动语言针测时，默认语音与 NVDA 语言地区不相同但同语系时无法切换的问题
*	修正自动切换语言无勾选时 WorldVoice 变更语音语言命令被滤掉的问题

### v1.5

*	数字读法分为 2 个设定选项「数字语言」与「数字模式」，将选项分为 2 维度以利选择
*	忽略数字间逗点选项使数值报读更正确
*	自动侦测语言功能当信任语音语言勾选时才使用不同解释档
*	语音设定中的值调整按确认才生效按取消会回到设定前的值
*	修正语音设定中当语音与默认语音相同时调整设定值后重启 NVDA 后回到设定前的值
*	将自动语言切换设定与语音设定窗口合并
*	地区与语音对应加入 no-select 用来取消对应
*	支持快捷键弹出语音设定与 Unicode 设定

### v1.4

*	修正检视报读内容开启时无语音
*	音调内部数值换算百分比改非线性计算，让默认值为 50
*	修正 unicode rule 强制模式下后方文字侦测错误
*	修正初始值类型错误导致语音设定对话框无法显示
*	初始语音改优先使用默认语言之语音

### v1.3

*	加入 unicode 设定功能
*	修正单数字不会自动切换的问题
*	修正数字模式在特定场景下失效问题
*	移除 v1.2 的第1驱动
*	调整程序结构并预支持更多 TTS

### v1.2

*	提供第 2 驱动核心，整体相比第 1 驱动核心顺畅，无偶尔速度不一致与小爆音问题
*	第 2 驱动功能比照第 1 驱动包括数字模式、中文空白间隔、忽略文件中的语言信息等选项
*	第 2 驱动提供各语音速度、音调、音量各别调整，但与第 1 驱动对应数值不同，亦即第 1 驱动的速度 50 与 第 2 驱动的速度 50 不会有相同的语音速度
*	修正数字模式在选择各数值语音下时间与小数点无正确朗读的问题
*	修正无定义字符地区信息时不朗读的问题
*	修正数字模式在选择各数字语音下无正确使用选择的语音的问题
*	调整数字模式与忽略文件中的语言信息处理顺序，更符合预期朗读逻辑

### v1.1

*	新增数字模式的选项，可选择有安装的语言朗读数字并可分为数值与数字两种。
*	新增忽略文件中的语言信息的选项，此主要是避免自动切换语言勾选且原始文件就有提供语言信息但不正确时(例如中文文字确标示英文语言)可能导致无法正确朗读；或是在 word 数字会被标示成英文语言导致自动改用英文语音朗读的状况。
*	优化中文空白间隔，使中文对象与中文属性间亦可停顿
*	加入其他中文语系的接口翻译
*	略过从配置文件加载变声功能，因目前 VE driver 底层的变声功能无法正常使用且换语音时容易因设定值不符加载失败导致要删整个配置文件才能解决
*	合并 VE driver 3.1.2 的更新
*	其他细部优化
