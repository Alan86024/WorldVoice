# WorldVoice 使用指南

隨著全球化的普及，人們接觸多國文字內容的機會也越來越多。無論是學習教材還是休閒閱讀，經常可見不同語言混合使用，甚至在同一句話中出現中英日多種語言文字。

各類數位內容（例如語言教材、數理資訊或文學作品）在文字結構、上下文脈絡和語言混用頻率上都會有所不同，因此使用螢幕閱讀器時，能夠根據內容特性與個人喜好靈活調整朗讀方式是一項非常重要的功能。

WorldVoice 是一款 NVDA 附加元件，支援 Espeak、OneCore、RHVoice 和 SAPI5 等多種語音引擎的角色之間的自動切換，並提供各種客製化設定。使用者可依據不同情境，輕鬆調整語音朗讀方式，滿足多元的需求。

## 功能特色

* 支援各語音角色獨立調整速度、音調與音量。
* 支援各種語音引擎的語音角色自動切換。
* 提供數字朗讀方式調整（數值模式或數字模式）。
* 可設定不同情境下語音停頓長度，包括數字之間、項目之間、中文之間，以及全文朗讀間的停頓。
* 根據 Unicode 字元自動偵測語言。

## 語音角色

在 WorldVoice 的語音角色設定面板中，您可以為不同語言設定專屬的語音角色，並針對每個角色個別調整速度、音調和音量等參數。

WorldVoice 會獨立儲存每個語音角色的設定值，切換角色時會套用相應的參數，讓語音角色能擁有各自的速度、音調與音量，這項功能特別有助於閱讀非母語的內容。

* 選擇地區後，語音列表會顯示該地區可用的語音角色，選擇您想使用的語音角色，即可完成地區與語音角色的對應設定。
* 選擇語音角色後，如果該角色支援變聲，將會顯示可用的變聲選項供您選擇。
* 選定語音角色後，速度、音調、音量滑桿，以及加快語速的核取方塊將變更為該角色的設定值。您調整的設定只會影響當前選定的語音角色，各個語音角色的設定值各自獨立。

### 一致性設定：

* 保持主要語音引擎與地區語音引擎一致：啟用後，主要語音角色與地區語音角色將只能是同個語音引擎下的語音角色。若調整主要語音角色時，發現地區語音角色原屬不同語音引擎，則該地區的語音角色會回復成未選擇狀態，並僅可重新選擇與主要語音角色相同引擎下的語音角色。
* 保持主要語音角色與地區語音角色一致：啟用後，主要語音角色與地區語音角色將保持一致。當您調整其中一方的語音角色設定時，另一方將自動同步為相同的語音角色。
* 保持不同語音角色之間的參數一致：啟用後，各語音角色之間的速度、音調、音量及加快語速參數將保持一致。調整任何一個語音角色的設定值，所有其他語音角色的設定值都會同步更新。

主要語音是 NVDA 語音設定面板所設定的語音角色。地區語音是 WorldVoice 語音角色設定面板中各地區所指定的語音角色。

## 語音流程

您可透過 WorldVoice 的語音流程面板設定各種語音流程的設定值，並選擇語音流程作用的範圍（全域或僅限 WorldVoice）。

* 支援全域使用的語音流程：忽略在數字間的逗號、數字模式、項目間停頓、數字間停頓、中文間停頓、讀出全部間停頓
* 僅限 WorldVoice 使用的語音流程：根據 Unicode 字元偵測語言、數字語言

根據 Unicode 字元偵測語言：啟用後將根據文字 Unicode 自動判斷語言地區並切換語音角色。注意：此功能可能與 NVDA 的自動語言切換功能衝突，建議避免同時啟用。

數字語言：朗讀數字時，使用此選項設定的地區角色進行朗讀

數字模式：

 * 數值模式：將數字作為數值朗讀，例如「12345」會讀作「一萬兩千三百四十五」。
 * 數字模式：逐字朗讀數字，例如「12345」會讀作「一二三四五」。

語音停頓調整：設定數字之間、項目之間、中文之間與全文朗讀之間的停頓時間，數值越小停頓越短，0 為不停頓。

忽略數字間的逗號：朗讀數字時忽略數字間逗號，以提高特定的語音角色朗讀數值的正確性。

支援全域使用的語音流程可透過 NVDA 的語音設定面板或 WorldVoice 的語音流程面板進行設定調整。而不支援全域使用的語音流程則僅能透過 NVDA 的語音設定面板進行調整。

## Unicode 偵測

* 偵測語言時忽略數字：勾選後，數字將忽略偵測，亦即會使用當前的語音角色進行朗讀。
* 偵測語言時忽略常見標點符號：勾選後，標點符號將忽略偵測，亦即會使用當前的語音角色進行朗讀。
* 語言偵測時間點：根據 Unicode 字元偵測語言並加入語言切換指令的處理時間點是在 NVDA 語音流程處理前或處理後。
* 字元集假設的語言：針對在 unicode 中屬多重語言共用的字元集，您可設定其假設的預設語言，目前支援拉丁、中日韓、阿拉伯等字元集。

## 備註

若您想要停用特定的語音引擎，您可以透過 WorldVoice 語音設定的語音引擎面板，將想停用的語音引擎的核取方塊取消勾選。

若您需要使用 RHVoice 語音引擎，請額外從 RHVoice 官方網站 下載相應的語音包附加元件。

# 更新版本日誌

## v3.7

* 修正 NVDA+b 功能無法使用的問題
* 修正睡眠模式下按鍵盤任意鍵語音中斷問題(語音角色設定中有任意 SAPI5 語音則不適用)(Workaround Solution)
* 同步 OneCore 程式與 NVDA 內 OneCore 做法

## v3.6

* 新增讀出全部停頓功能，可在讀出全部時的片段間停頓
* 修正特定情境中無法保存設定的問題
* 加入烏克蘭語翻譯，感謝 VovaMobile 的貢獻

## v3.5

*	修正 aisound 音量回避 bug
*	修正 VE 遇 utf8 4bit 字元會讓後續文字不朗讀的問題
*	修正 VE 遇 unicode utf8 編碼錯誤時文字不朗讀的問題
*	在語音設定新增引擎分類，可選擇要啟用的語音引擎，預設為 VE, OneCore, aisound
*	相容於 NVDA 版本 2023.1

## v3.4

* 新增數字間停頓，提身數字內容聽讀判斷
* 新增項目間停頓功能，提身物件資訊聽讀判斷
* 修正 VE 數字模式為數值時會合併相鄰數字成為單一數值報讀
* 修正 OneCore 語速調整問題
* 修正 VE 開啟「游標移動時延遲讀出字元的字詞解釋」後遊標移動卡頓問題
* 修正 OneCore 與 RHVoice 「游標移動時延遲讀出字元的字詞解釋」無效的問題

## v3.3

* 支援 OneCore engine
* 地區與語音角色對應為 No Select 時使用主語音朗讀
* 修正符號轉中文報讀時會套用到中文空白停頓參數的問題
* 語音設定使用類別設定對話框，分為語音角色、語言切換、其他
* 在語音設定中的其他分類下加入 OneCore 加快語速開關
* 支援 RHVoice engine

## v3.2

*	修正在語音合成器非選擇 WorldVoice 時，語音設定問題，改以顯示提示文字
*	修正 aisound 音量調整問題
*	修正語音設定中偵測語言時間點的重啟條件
*	修正長按按鍵後語音無法中斷問題
*	修正多項語意問題(flake8)
*	相容於 NVDA 版本 2022.1

## v3.1

*	在網頁瀏覽中中斷無聲報讀
*	shift 可暫停/繼續語音報讀
*	按加減音量鍵不會中斷報讀
*	保持主要語音引擎與地區語音引擎一致功能
*	修正 VE 停頓的方式

## v3.0

*	支援 SAPI5 語音引擎
*	支援 Aisound 語音引擎
*	語音設定內新增語音角色切換時停頓長度
*	語音設定內新增 unicode 正規化方式選項
*	語音角色排序方式調整依語音引擎、語音角色名稱排序

## v2.2

*	語音設定內新增變聲選項，需依序設定地區、語音、變聲選項
*	修政偵測語言時間點選「符號處理前」後無法再變更之問題
*	新增阿拉伯語系翻譯

## v2.1

*	相容於 NVDA 版本 2019.3~ 2021.1
*	可套用 NVDA 不同組態設定
*	移除輸入手勢的多餘項目
*	速度內部數值換算百分比改非線性計算
*	設定選單調整將「在符號處理後偵測文字語言」更改為「偵測語言時間點」
*	偵測語言時間點：字元自動偵測語言時間點在 NVDA 的符號處理前或後進行。當選擇「符號處理後」項目時，可防止與其他使用到語音模組附加元件(ex: Instant Translate)的衝突
*	保持主要語音參數與地區語音參數一致：將 NVDA 語音設定中的語音（主要語音）與 WorldVoice 語音設定中的地區對應語音（地區語音）參數（速度、音調、音量）一致，當主要語音或地區語音設定調整時，同步調整雙方的語音參數設定
*	保持主要語音角色與地區語音角色一致：將 NVDA 語音設定中的語音（主要語音）角色與 WorldVoice 語音設定中的地區對應語音（地區語音）角色一致，當主要語音或地區語音設定調整時，同步調整雙方的語音角色設定

## v2.0

*	相容 NVDA 2021.1

## v1.7

*	小數點不讀修正(三數字間皆有小數點情形)
*	相容 NVDA 2021.1 以前的最後一版

## v1.6

*	修正數字模式下小數點不朗讀問題
*	更新 VE 核心包工作目錄，未來更新時可無需重新匯入
*	將「使用 WorldVoice 設定規則針測語言」的開關與「自動切換語言」的開關分開，避免部份情境兩者不相容問題。
*	修正啟用 unicode 自動語言針測時，預設語音與 NVDA 語言地區不相同但同語系時無法切換的問題
*	修正自動切換語言無勾選時 WorldVoice 變更語音語言命令被濾掉的問題

## v1.5

*	數字讀法分為 2 個設定選項「數字語言」與「數字模式」，將選項分為 2 維度以利選擇
*	忽略數字間逗點選項使數值報讀更正確
*	自動偵測語言功能當信任語音語言勾選時才使用不同解釋檔
*	語音設定中的值調整按確認才生效按取消會回到設定前的值
*	修正語音設定中當語音與預設語音相同時調整設定值後重啟 NVDA 後回到設定前的值
*	將自動語言切換設定與語音設定視窗合併
*	地區與語音對應加入 no-select 用來取消對應
*	支援快速鍵彈出語音設定與 Unicode 設定

## v1.4

*	修正檢視報讀內容開啟時無語音
*	音調內部數值換算百分比改非線性計算，讓預設值為 50
*	修正 unicode rule 強制模式下後方文字偵測錯誤
*	修正初始值類型錯誤導致語音設定對話框無法顯示
*	初始語音改優先使用預設語言之語音

## v1.3

*	加入 unicode 設定功能
*	修正單數字不會自動切換的問題
*	修正數字模式在特定場景下失效問題
*	移除 v1.2 的第1驅動
*	調整程式結構並預支援更多 TTS

## v1.2

*	提供第 2 驅動核心，整體相比第 1 驅動核心順暢，無偶爾速度不一致與小爆音問題
*	第 2 驅動功能比照第 1 驅動包括數字模式、中文空白間隔、忽略文件中的語言資訊等選項
*	第 2 驅動提供各語音速度、音調、音量各別調整，但與第 1 驅動對應數值不同，亦即第 1 驅動的速度 50 與 第 2 驅動的速度 50 不會有相同的語音速度
*	修正數字模式在選擇各數值語音下時間與小數點無正確朗讀的問題
*	修正無定義字元地區資訊時不朗讀的問題
*	修正數字模式在選擇各數字語音下無正確使用選擇的語音的問題
*	調整數字模式與忽略文件中的語言資訊處理順序，更符合預期朗讀邏輯

## v1.1

*	新增數字模式的選項，可選擇有安裝的語言朗讀數字並可分為數值與數字兩種。
*	新增忽略文件中的語言資訊的選項，此主要是避免自動切換語言勾選且原始文件就有提供語言資訊但不正確時(例如中文文字確標示英文語言)可能導致無法正確朗讀；或是在 word 數字會被標示成英文語言導致自動改用英文語音朗讀的狀況。
*	優化中文空白間隔，使中文物件與中文屬性間亦可停頓
*	加入其他中文語系的介面翻譯
*	略過從設定檔載入變聲功能，因目前 VE driver 底層的變聲功能無法正常使用且換語音時容易因設定值不符載入失敗導致要刪整個設定檔才能解決
*	合併 VE driver 3.1.2 的更新
*	其他細部優化
