# WorldVoiceXVE

WorldVoiceXVE 是依據 VE driver 為基礎開發而成的 addon。運行於 NVDA 2019.3 以上。

主要包括有多國語音自動切換、各別語音速度設定、朗讀行為客製(數字讀法、中文空格間隔)等功能。

## 安裝

*	下載主程式addon WorldVoiceXVE、VE 語音包addon、VE 核心包。
*	安裝主驅動 addon
*	核心包可透過 WorldVoiceXVE -> 檔案匯入將 zip 壓縮包匯入語音元件工作區。
*	核心包分為 2 種版本，分別對應第 1 驅動與第 2 驅動使用，請留意匯入對應的工作區，如將第 1 驅動核心包匯入第 2 驅動或反之將無法正常運作
*	語音包安裝方式
	*	基本：使用兼容於 Vocalizer for NVDA 的語音包addon，[官方下載點](https://vocalizer-nvda.com/downloads)。
	*	進階：可透過各種語音包內直接複製其內的地區資料夾(ex: en, mnc, mnt)等並將其壓成 zip 壓縮包後透過 WorldVoiceXVE 介面的檔案匯入功能匯入addon內，與核心包相同需留意匯入之工作區，如無特殊需求建議使用 addon 版本安裝，因 addon 版本可共享同時提供第 1 驅動與第 2 驅動使用。

## 相依性套件

除以上安裝外，為驅動 VE 核心，需安裝 [VC++ Redistributable Packages 2012](https://www.microsoft.com/en-US/download/details.aspx?id=30679)的 x86 版本 (VSU_4\vcredist_x86.exe) 後即可順利驅動。

## 使用

*	NVDA+ctrl+S 選擇 WorldVoiceXVE 語音合成器。
*	NVDA+ctrl+V 有基本語音速度、音調、音量等基本設定，其中數字模式、中文空白間隔為 WorldVoiceXVE 多的客製設定。
	*	數字模式：有預設(VE 預設的讀法)、自動數字(以預設語音並盡可能以數字報讀)、中文數字(強制使用中文數字讀法)、英文數字(強制使用英文數字讀法)
	*	中文空白間隔：可設定中文間有空白時，欲停頓長度，數字愈小停頓愈短， 0 為不停頓。
*	 WorldVoiceXVE -> 自動語言切換設定：可設定不同地區所使用的語音角色。
	*	先選擇地區後語音列表會列出該地區可用的語音，選擇後即完成該地區與語音的對應紀錄。
	*	用 unicode 編碼偵測文字語言勾選後，元件會根據讀到的字元偵測地區。
	*	偵測語言時忽略數字和常見標點符號勾選後，數字與標點符號會認為是預設語音的地區文字。
*	 WorldVoiceXVE -> 語音速度設定：可設定不同語音角色的朗讀速度。
	*	同樣先選擇地區後語音列表會列出該地區可用的語音，再選擇好語音後，便可於速度滑桿調整數值。
	*	速度是依不同語音區分，每個語音有各自不同的速度數值，而非依地區區分。
*	 WorldVoiceXVE -> 檔案匯入：可匯入檔案，可用於匯入核心包與語音包。

## 更新版本日誌

### v1.1

*	新增數字模式的選項，可選擇有安裝的語言朗讀數字並可分為數值與數字兩種。
*	新增忽略文件中的語言資訊的選項，此主要是避免自動切換語言勾選且原始文件就有提供語言資訊但不正確時(例如中文文字確標示英文語言)可能導致無法正確朗讀；或是在 word 數字會被標示成英文語言導致自動改用英文語音朗讀的狀況。
*	優化中文空白間隔，使中文物件與中文屬性間亦可停頓
*	加入其他中文語系的介面翻譯
*	略過從設定檔載入變聲功能，因目前 VE driver 底層的變聲功能無法正常使用且換語音時容易因設定值不符載入失敗導致要刪整個設定檔才能解決
*	合併 VE driver 3.1.2 的更新
*	其他細部優化

### v1.2

*	提供第 2 驅動核心，整體相比第 1 驅動核心順暢，無偶爾速度不一致與小爆音問題
*	第 2 驅動功能比照第 1 驅動包括數字模式、中文空白間隔、忽略文件中的語言資訊等選項
*	第 2 驅動提供各語音速度、音調、音量各別調整，但與第 1 驅動對應數值不同，亦即第 1 驅動的速度 50 與 第 2 驅動的速度 50 不會有相同的語音速度
*	修正數字模式在選擇各數值語音下時間與小數點無正確朗讀的問題
*	修正無定義字元地區資訊時不朗讀的問題
*	修正數字模式在選擇各數字語音下無正確使用選擇的語音的問題
*	調整數字模式與忽略文件中的語言資訊處理順序，更符合預期朗讀邏輯
