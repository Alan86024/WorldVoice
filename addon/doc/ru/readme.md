# Мультидрайвер WorldVoice

* автор: Tseng Woody
* <tsengwoody.tw@gmail.com>
* [Страница дополнения на GitHub](https://github.com/tsengwoody/WorldVoice)

Изучение иностранных языков приобретает все большее значение в эпоху высокой сетевой интеграции и интернационализации. В материалах по изучению иностранных языков часто используется родной язык для объяснения лексики и предложений на иностранных языках, а также часто встречается смешение двух и более языков. В повседневной жизни мы часто используем смесь языков и слов в общении и дискуссиях. В книгах, газетах и интернет-статьях мы часто видим смешение нескольких языков для передачи информации, а в некоторых случаях даже в одном предложении китайский, английский, китайский и японский.

Различный цифровой контент (например, для изучения иностранных языков, математики и естественных наук, литературы) имеет разный состав текста, контекстуальное значение и межъязыковые частоты, и для лучшего удовлетворения потребностей таких документов может потребоваться тонкая настройка соответствующего звукового представления для разных видов цифрового контента.

WorldVoice - это многоязычное приложение для читателя экрана NVDA, которое поддерживает пять языковых синтезаторов (VE, OneCore, Aisound, SAPI5 и RHVoice) и предоставляет разнообразные возможности их настройки. Пользователи могут подстраивать свои настройки под различные контексты, максимально удовлетворяя свои потребности.

### Основными возможностями являются:

* Автоматическое переключение между несколькими языками
* Индивидуальные настройки параметров речи (скорость, высота голоса, громкость)
* Поддержка нескольких синтезаторов
* Переключение между режимами чтения чисел (цифры и числовые значения)
* Возможность настройки поведения чтения речи (длительность паузы для чисел, элементов, китайских пробелов, игнорирование запятой между числами)
* Возможность настройки области текста.


## Установка

В дополнение к общим шагам установки приложения NVDA, если вы хотите использовать голоса VE и aisound, вам необходимо установить пакеты с ядром. Если вы хотите использовать голоса VE и RHVoice, вам необходимо установить пакеты с этими голосами.

Вот шаги по установке основных пакетов:

* Перейдите в WorldVoice - > установить ядро VE или установить ядро Aisound и импортируйте соответствующие zip-файлы основных пакетов в WorldVoice.
* Если вы используете ядро VE, вам также 
необходимо установить версию x86 [VC++ Redistributable Packages 2012](https://www.microsoft.com/en-US/download/details.aspx?id=30679) в вашей операционной системе (VSU_4\vcredist_x86.exe). Если вы уже установили базовый и голосовой пакеты, но по-прежнему не можете загрузить синтезатор WorldVoice, попробуйте установить этот компонент.

Вот шаги по установке голосовых пакетов:

* Если вы хотите использовать голос RHVoice, Пожалуйста, загрузите соответствующий голосовой пакет с официального сайта. [Официальная 
страница загрузки](https://rhvoice.ru/languages/).
* Если вы хотите использовать голос VE, вы можете напрямую скопировать региональные папки (например, en, mnc, mnt и т. д.) из приложения в голосовой пакет VE и сжать их в zip-файл. Затем импортируйте его в WorldVoice с помощью функции "импорт файлов" в интерфейсе WorldVoice. Поскольку форма приложения может быть несовместима из-за версии NVDA, из-за чего голосовой пакет VE может не загружаться нормально после обновления 
NVDA, рекомендуется установить голосовой пакет с помощью этого метода импорта файлов. Кроме того, вы можете использовать форму голосового пакета Vocalizer expressive  "nvda-addon" и загрузить соответствующий голосовой пакет с официального веб-сайта, совместимого с VOCALIZER для NVDA. [Официальная страница загрузки](https://vocalizer-nvda.com/downloads).



## настройка

Нажмите NVDA+ctrl+S и в диалоге выбора синтезатора выберите синтезатор речи WorldVoice.

### Настройка роли главного голоса

Первым делом выберите голос (NVDA+ctrl+V), чтобы установить базовую голосовую роль и общее поведение

* Настройка скорости, высоты и громкости голоса
* Метод чтения чисел: разделен на 2 параметра "Язык чисел" и "Режим чисел", язык чисел устанавливает голосовую роль, используемую при чтении чисел, а режим чисел делится на два параметра: числовые значения и цифры
* Параметры пауза между цифрами, элементами и китайскими пробелами позволяют установить длительность паузы между речью в различных контекстах, чем меньше число, тем короче пауза, 0 - пауза отсутствует.
* Игнорировать запятую между цифрами: параметр игнорирует запятую между цифрами, когда она обозначена, позволяя зачитывать значение вслух, даже если запятая стоит не там, где нужно.
* Включить правила настройки WorldVoice для определения языка текста: если флажок установлен, правила настройки WorldVoice используются для определения языка текста и переключения чтения голосом. В некоторых случаях этот параметр может иметь проблемы с совместимостью с автоматическим переключением языков NVDA, поэтому рекомендуется не использовать эти два параметра одновременно

### Настройка речи WorldVoice

(меню NVDA - > WorldVoice - > Настройки речи)

Роль речи: вы можете установить роли голоса для разных языков — скорость, высоту тона, громкость каждого голоса и согласованность между ролью основного голоса и ролью дополнительного голоса.

* После выбора языка появится список голосов, доступных для этого языка.
* После выбора голоса появится список вариантов, доступных для этого голоса.
* После выбора голоса ползунки скорости, высоты и громкости, расположенные ниже,  изменятся на значения, установленные для этого голоса.
* Скорость, высота и громкость различаются в зависимости от голоса, причем каждый голос имеет разное значение скорости, которое не зависит от выбранного языка.
* Сохранять согласованность основного и дополнительного синтезаторов: синхронизируйте основной голос в настройках голоса NVDA с дополнительным голосом в настройках голоса WorldVoice, чтобы при изменении настроек основного голоса дополнительный голос синхронизировался с тем же синтезатором.
* Сохранять согласованность между основным и дополнительным голосом: синхронизируйте роль основного голоса в настройках голоса NVDA с ролью дополнительного голоса в настройках голоса WorldVoice, и при изменении настроек основного или дополнительного голоса настройки голосовых ролей для обоих голосов будут изменяться одновременно.
* Сохранять согласованность параметров основного и дополнительного голосов: синхронизируйте параметры основного голоса в настройках голоса NVDA с параметрами дополнительного голоса в настройках голоса WorldVoice (скорость, высота, громкость), и при изменении параметров основного или дополнительного голоса одновременно будут изменяться параметры обоих голосов.

Переключение языка:

* Определять язык текста на основе символов Юникода — этот флажок изначально установлен, он указывает приложению определять язык текста на основе прочитанных символов.
* Игнорировать цифры при определении языка, игнорировать общие знаки препинания при определении языка-это флажки, указывающие, будут ли цифры и знаки препинания учитываться при определении 
основного языка.
* Улучшить команды речи: язык текста распознается автоматически, речевая команда паузы оценивается и добавляется в определенный момент времени до или после обработки символов NVDA. Параметр "после обработки NVDA", предотвращает конфликты с другими приложениями, использующими языковой модуль (например, Instant Translate).

Синтезатор речи: вы можете выбрать синтезаторы, которые будут включены, изначально это VE, OneCore, aisound.

Другое:

* Повышение скорости OneCore: отметьте этот флажок, чтобы ускорить 
воспроизведение языковых символов OneCore
* Параметр "Пауза VE": устанавливает длительность паузы в начале и в конце сеанса речи голосов VE.
* Замена цифровой точки: устанавливает способ зачитывания десятичных точек в числах.


### Другие настройки:

WorldVoice -> Настройки Юникода: вы можете указать язык, к которому принадлежит символ, и указать язык символа в соответствии с контекстом или в обязательном режиме, когда отмечено "Определять язык текста на основе символов юникода", автоматическое определение будет добавлено в правила этого профиля. Эта функция может решить проблему нечитания вслух в соответствии с внутренними правилами преобразования символов NVDA при переключении языка. Например, в некоторых случаях символ "." не читается, попробуйте добавить его в список правил, чтобы он читался правильно.

WorldVoice -> Импорт файлов: вы можете импортировать файлы, которые могут быть использованы для импорта речевых пакетов.

### Перевод

* Валентин Куприянов, Русский язык.

Примечание:
С WorldVoice версии 3.3 реализована поддержка синтезаторов речи RHVoice и OneCore.
С WorldVoice версии 3.0 реализована поддержка синтезаторов речи AiSound, SAPI5, VocalizerExpressive 2 и 1.
Этот драйвер без интегрированных ядер, а также с интегрированнными ядрами с пометкой (Mod1, Mod2, Mod3) можно найти в русскоязычном каталоге дополнений:
<https://nvda-addons.ru>


## Журнал версий

### V3.6

* Добавлена функция чтения всех пауз, которая может делать паузы между фрагментами в режиме Читать всё
* Исправлена ошибка, из-за которой настройки не могли быть сохранены в определенных ситуациях.
* Добавлен украинский перевод, спасибо VovaMobile.

### V3.5

* Исправлена ​​ошибка, избегающая громкости AiSound.
* Исправлена ​​проблема, из-за которой VE не читала следующий текст при встрече с 4-битными символами utf8.
* Исправлена ​​проблема, из-за которой текст не читался вслух, когда VE обнаруживает ошибку кодирования unicode utf8.
* Добавлена ​​категория движка в настройках голоса, вы можете выбрать голосовой движок для включения, по умолчанию VE, OneCore, aisound, SAPI5, RH.
* Совместим с NVDA версии 2023.1.

### v3.4

* Добавлена пауза между номерами, чтобы улучшить восприятие цифрового контента при прослушивании и чтении
* Добавлена функция паузы между элементами для улучшения прослушивания, чтения и оценки информации об объекте
* Исправлено, что когда режим пяти чисел является числовым значением, соседние цифры будут объединены в одно числовое значение для регистрации для чтения
* Исправлена проблема с настройкой скорости речи OneCore
* Исправлена ошибка, из-за которой движение курсора зависало после того, как мы включили "Интерпретацию слов, которая задерживает считывание символов при перемещении курсора".
* Исправлена ошибка, из-за которой "Интерпретация слов OneCore и RHVoice, которая задерживает считывание символов при перемещении курсора", была недопустимой.

### v3.3

* Поддержка движка OneCore
* Используйте основной голос для чтения вслух, когда регион и роль голоса соответствуют отсутствию выбора
* Исправлена ошибка, из-за которой символ применялся к китайскому параметру пустой паузы при переводе на китайский для регистрации
* Настройки голоса используйте диалоговое окно настройки категории, которое разделено на голосовые роли, переключение языка и другие.
* Добавлен переключатель ускорения OneCore в разделе другое категории в настройках голоса
* Поддержка RHVoice engine

### v3.2

* Исправлена проблема настройки голоса, когда WorldVoice не выбран в голосовом синтезаторе, теперь отображается текст подсказки.
* Исправлена проблема с регулировкой громкости звука.
* Исправлено условие перезапуска для обнаружения временных точек языка в настройках голоса
* Исправлено длительное нажатие клавиши, из-за которого речь не прерывалась
* Исправлены различные семантические проблемы (flake8)
* Совместимость с NVDA версии 2022.1

### v3.1

* прерывание беззвучных объявлений во время просмотра веб-страниц
* переключить, чтобы приостановить/продолжить голосовое оповещение
* Нажатие кнопки увеличения или уменьшения громкости не прерывает чтение
* Поддерживать согласованность между основным голосовым движком и региональными голосовыми движками
* Исправлено то, как ВЭ делает паузы

### v3.0

* Поддержка голосового движка SAPI5
* Поддержка голосового движка Aisound
* Новая длительность паузы при переключении между ролями голоса в настройках голоса
* Новая опция нормализации юникода в настройках голоса
* Сортировка голосовых персонажей по голосовому движку и имени персонажа

### v2.2

* Новая опция изменения голоса в настройках голоса, необходимо установить регион, голос и опции изменения голоса по порядку
* Исправлена проблема, из-за которой время определения языка не могло быть изменено после выбора "перед обработкой символов".
* Добавлен арабский перевод

### v2.1

* Совместимость с NVDA версий 2019.3~2021.1
* Настройки конфигурации NVDA могут быть применены
* Удалены лишние жесты ввода.
* Процент преобразования внутреннего значения скорости изменен на нелинейный расчет
* Настройка меню настроек для изменения "Определять язык текста после обработки символов" на "Определять временную точку языка".
* Определение языковой точки во времени: символ автоматически определяет языковую точку во времени до или после обработки символа NVDA. При выборе пункта 'После обработки символов' можно предотвратить конфликты с другими дополнениями, использующими речевой модуль (например, Instant Translate).
* Поддерживайте согласованность между параметрами основного голоса и параметрами регионального голоса: согласуйте параметры голоса (основной голос) в настройках голоса NVDA с параметрами регионального аналога (региональный голос) (скорость, высота тона, громкость) в настройках голоса WorldVoice и регулируйте параметры обоих голосов одновременно при настройке параметров основного или регионального голоса.
* Поддерживайте согласованность между основной и региональной ролью голоса: согласуйте роль голоса (основной голос) в настройке голоса NVDA с ролью регионального аналога (региональный голос) в настройке голоса WorldVoice и настройте обе роли голоса одновременно, когда настраивается основная или региональная роль голоса.

### v2.0

* Совместимость с NVDA 2021.1

### v1.7

* Исправлена нечитаемость десятичной точки (десятичная точка между всеми тремя числами)
* Совместимость с предыдущей финальной версией NVDA 2021.1

### v1.6

* Исправлена десятичная точка, не читаемая вслух в числовом режиме
* Обновлена рабочая директория основного пакета VE, чтобы позволить будущие обновления без повторного импорта.
* Разделили переключатель "Использовать WorldVoice для установки правил для целевого языка" и переключатель "Автоматически переключать язык", чтобы избежать несовместимости между ними в некоторых случаях.
* Исправлена проблема при включении автоматического определения языка в юникоде, когда язык по умолчанию не совпадал с языковым регионом NVDA, но был на том же языке.
* Исправлена команда смены языка WorldVoice, которая отфильтровывалась, когда автопереключение языка снято.

### v1.5

* Чтение чисел разделено на 2 варианта настройки "Язык чисел" и "Режим чисел", которые для удобства выбора разделены на 2 измерения
* Опция игнорирования межразрядных запятых для корректного чтения числовых отчетов
* Функция автоматического определения языка использует различные файлы интерпретации только в том случае, если отмечен доверенный язык
* Настройка значения в голосовой настройке вступит в силу, только если вы нажмете подтверждение и отмену, чтобы вернуться к значению до настройки
* Фиксация значения в настройках голоса, когда голос совпадает с голосом по умолчанию, а затем перезапуск NVDA возвращает предустановленное значение
* Объединение автоматического переключения языка с окном настройки голоса
* Добавить отмену выбора для региона и голосового отображения для отмены отображения.
* Поддержка всплывающих окон с быстрыми клавишами для голосовых настроек и настроек Unicode

### v1.4

* Исправлено отсутствие голоса при просмотре отчета
* Процент преобразования внутреннего значения тона изменен на нелинейный, так что значение по умолчанию равно 50
* Исправлена ошибка обнаружения заднего текста в принудительном режиме правил юникода
* Исправлен неверный тип начального значения, приводивший к невозможности отображения диалогового окна настройки голоса
* Начальный голос изменен, чтобы отдать предпочтение голосу языка по умолчанию

### v1.3

* Добавьте функцию настройки юникода
* Исправлена проблема, при которой одиночные цифры не переключались автоматически
* Исправлен цифровой режим, не работающий в некоторых сценах.
* Удален драйвер 1 из версии 1.2
* Скорректирована структура программы и поддерживается больше TTS

### v1.2

* Доступен драйвер 2, в целом более плавный, чем драйвер 1, без случайных нестыковок скорости и небольших всплесков.
* Особенности драйвера 2 включают цифровой режим, китайский пробел, игнорирование информации о языке в файлах и другие опции по сравнению с драйвером 1.
* Драйвер 2 обеспечивает индивидуальную регулировку скорости, высоты тона и громкости, но соответствующие значения отличаются от драйвера 1, т.е. скорость 50 драйвера 1 и скорость 50 драйвера 2 не будут иметь одинаковую скорость речи
* Исправлена проблема, из-за которой время и десятичные точки неправильно считывались в числовом режиме при выборе каждого значения речи
* Исправлена проблема, при которой информация об области не читалась вслух, если не был определен символ
* Исправлена проблема, при которой числовой режим не использовал выбранный голос правильно при выборе каждого числового голоса
* Скорректирован порядок обработки языковой информации в числовом режиме и игнорирования файлов, чтобы лучше соответствовать ожидаемой логике чтения.

### v1.1

* Новая опция для числового режима, которая позволяет читать вслух числа на установленном языке и разделять их на цифровые и числительные.
* Новая опция игнорирования языковой информации в документах. Это сделано для того, чтобы избежать возможности неправильного чтения вслух, когда флажок языка автоматически переключается, а в исходном документе содержится неправильная языковая информация (например, китайский текст помечен как английский язык) или когда номера слов помечены как английский язык и автоматически читаются вслух на английском языке.
* Оптимизация китайских пустых пространств, чтобы китайские объекты и китайские атрибуты могли быть поставлены на паузу
* Добавьте перевод интерфейса для других китайских языков
* Пропустить загрузку функции изменения голоса из файла конфигурации, поскольку функция изменения голоса, лежащая в основе текущего драйвера VE, не работает должным образом, и при изменении голоса легко удалить весь файл конфигурации из-за сбоя загрузки настроек
* Объединено с обновлениями драйвера VE 3.1.2
* Другие незначительные улучшения
